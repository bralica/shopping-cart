function loadData(){showCategoriesInMenu(getAndLoadCategoriesInMenu("http://services.odata.org/V3/Northwind/Northwind.svc/Categories?$format=json")),getData("http://services.odata.org/V3/Northwind/Northwind.svc/Products?$format=json"),checkLogin()}function checkLogin(){sessionStorage.getItem("loggedUser")||(window.location.href="index.html")}function loginUser(e,t){var r=getServiceData("http://services.odata.org/V3/Northwind/Northwind.svc/Employees?$format=json").value,o=!1;for(var n in r)if(r[n].FirstName==e&&r[n].LastName==t){o=!0,sessionStorage.setItem("loggedUser",r[n].FirstName);break}o?redirect():(document.getElementById("errorMessage").innerHTML="Uneti podaci nisu ispravni. Pokušajte ponovo",document.getElementById("errorMessage").className="errorMessage")}function logoutUser(){sessionStorage.getItem("loggedUser")&&(sessionStorage.clear(),window.location.href="index.html")}function redirect(){window.location.href="cart.html"}function Product(e,t,r){this.proizvodId=e,this.proizvodCena=t,this.proizvodKolicina=r}function prepareElement(e){var t=e.id,r="cena"+e.id,o="kolicina"+e.id,n=document.getElementById(r).outerText,a=document.getElementById(o).valueAsNumber;n=Number(n),a=Number(a);var i=new Product(t,n,a);return i}function takeCategory(e,t){for(var r in t)if(t[r].CategoryID==e)return t[r].CategoryName}function takeProductName(e,t){for(var r in t)if(t[r].ProductID==e)return t[r].ProductName}function takeProductId(e,t){for(var r in t)if(t[r].ProductName==e)return t[r].ProductID}function takeCategoryIdFromProducts(e,t){for(var r in t)if(t[r].ProductID==e)return t[r].CategoryID}function takeImage(e,t){for(var r in t)if(t[r].id==e)return t[r].path}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function findCategory(e,t){for(var r in e)return e[r].CategoryName==t?e[r].CategoryID:!1}function getAndLoadCategories(e){var t=getCategoryData(e).value,r="";for(var o in t){var n=t[o].CategoryID,a=t[o].CategoryName;for(var o in t){var n=t[o].CategoryID,a=t[o].CategoryName;r+='<option value="'+n+'">'+a+"</option>"}return r}var i=0;return r+='<li><a href="#" id="'+i+"\" onclick=\"getData('http://services.odata.org/V3/Northwind/Northwind.svc/Products?$format=json',"+i+')">Svi proizvodi</a></li>'}function showCategories(e){document.getElementById("categoryName").innerHTML=e}function showCategoriesInMenu(e){document.getElementById("categoryNav").innerHTML=e}function removeChildElements(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function insertProductInCart(e,t,r){var o=new Product(e,t,r);shoppingCart.push(o)}function findInArray(e,t){for(var r=0;r<t.lenght;r++)if(t.propertyName==e)return!0;return!1}function getData(e,t){var r=document.getElementById("addProduct");removeChildElements(r);var o=getServiceData(e).value;for(var n in o){var a=takeImage(getRandomInt(1,4),slike),i=takeCategory(o[n].CategoryID,categories);(void 0==t||""==t)&&(t=0,createProduct(a,o[n].UnitPrice,o[n].ProductName,o[n].CategoryID)),o[n].CategoryID==t&&createProduct(a,o[n].UnitPrice,o[n].ProductName,o[n].CategoryID),"string"==typeof t&&(o[n].ProductName.toLowerCase().indexOf(t.toLowerCase())>=0||i.toLowerCase().indexOf(t.toLowerCase())>=0)&&createProduct(a,o[n].UnitPrice,o[n].ProductName,o[n].CategoryID)}document.getElementById("itemsInCart").innerHTML="KATALOG PROIZVODA"}function getServiceData(e,t,r){try{var o,n=new XMLHttpRequest;return n.onreadystatechange=function(){if(4==n.readyState){if(200!=n.status)return!1;o=JSON.parse(n.response)}},n.open("GET",e,!1,t,r),n.send(),o}catch(a){return a}}function getCategoryData(e,t,r){try{var o,n=new XMLHttpRequest;return n.onreadystatechange=function(){if(4==n.readyState){if(200!=n.status)return!1;o=JSON.parse(n.response)}},n.open("GET",e,!1,t,r),n.send(),o}catch(a){return a}}function getAndLoadCategoriesInMenu(e){var t=getCategoryData(e).value,r="";for(var o in t){var n=t[o].CategoryName,a=t[o].CategoryID;r+='<li><a href="#" id="'+a+"\"onclick=\"getData('http://services.odata.org/V3/Northwind/Northwind.svc/Products?$format=json',"+a+')">'+n+"</a></li>"}var i=0;return r+='<li><a href="#" id="'+i+"\" onclick=\"getData('http://services.odata.org/V3/Northwind/Northwind.svc/Products?$format=json',"+i+')">Svi proizvodi</a></li>'}function createProduct(e,t,r,o){var n=document.getElementById("addProduct"),a=document.getElementsByClassName("priceTag").length;cntProduct=void 0==a||0==a?cntProduct:a;var i=document.createElement("div");i.setAttribute("class","col-md-3 col-sm-6 introFadeIn"),n.appendChild(i);var d=document.createElement("p");d.setAttribute("class","product-title"),d.innerHTML=r,i.appendChild(d);var c=takeCategory(o,categories),s=document.createElement("p");s.setAttribute("class","text-left category-title"),s.innerHTML=c,i.appendChild(s);var u=document.createElement("img");u.setAttribute("src",e),u.setAttribute("alt","proizvod"),u.setAttribute("class","img-responsive"),u.setAttribute("width","200"),i.appendChild(u);var l=document.createElement("p");l.setAttribute("class","valuta text-left"),l.innerHTML="rsd",i.appendChild(l),cntProduct+=1;var m=document.createElement("p");m.setAttribute("id","cenaP"+cntProduct),m.setAttribute("class","priceTag"),m.innerHTML=t,i.appendChild(m);var p=document.createElement("div");p.setAttribute("class","clr"),i.appendChild(p);var g=document.createElement("input");g.setAttribute("type","number"),g.setAttribute("value","1"),g.setAttribute("id","kolicinaP"+cntProduct),i.appendChild(g);var v=document.createElement("p");v.setAttribute("class","text-muted"),v.innerHTML="kolicina",i.appendChild(v);var h=document.createElement("button");h.setAttribute("class","btn btn-success btn-sm"),h.setAttribute("id","P"+cntProduct),h.setAttribute("onclick","addItem(this)"),h.innerHTML="Dodaj u korpu",i.appendChild(h);var C=document.createElement("button");C.setAttribute("class","btn btn-danger btn-sm"),C.setAttribute("id","P"+cntProduct),C.setAttribute("onclick","removeItem(this)"),C.innerHTML="Ukloni iz korpe",i.appendChild(C)}function removeItem(e){var t=prepareElement(e),r="kolicina"+t.proizvodId;for(var o in shoppingCart)shoppingCart[o].proizvodId==t.proizvodId&&(shoppingCart[o].proizvodKolicina>=t.proizvodKolicina?(shoppingCart[o].proizvodKolicina=shoppingCart[o].proizvodKolicina-t.proizvodKolicina,suma-=t.proizvodKolicina*t.proizvodCena,0>suma&&(suma=0),0==shoppingCart[o].proizvodKolicina&&shoppingCart.splice(o,1)):alert("Uneta kolicina je veca od broja proizvoda u korpi! Broj proizvoda u korpi je: "+shoppingCart[o].proizvodKolicina));document.getElementById("suma").innerHTML=suma+" rsd",1!=t.proizvodKolicina&&(document.getElementById(r).value=1),0==shoppingCart.length&&(alert("Korpa je prazna"),redirect())}function addItem(e){var t=prepareElement(e),r="kolicina"+t.proizvodId,o=!1;for(var n in shoppingCart)if(shoppingCart[n].proizvodId==t.proizvodId){shoppingCart[n].proizvodKolicina+=t.proizvodKolicina;{shoppingCart[n].proizvodKolicina}o=!0}o||insertProductInCart(t.proizvodId,t.proizvodCena,t.proizvodKolicina),suma+=t.proizvodCena*t.proizvodKolicina,document.getElementById("suma").innerHTML=suma+" rsd",0==t.proizvodKolicina&&(document.getElementById(r).value=1)}function showProductsInCart(e){var t=document.getElementById("addProduct");removeChildElements(t),(0==shoppingCart.length||void 0==shoppingCart.length)&&(alert("VAŠA KORPA JE PRAZNA"),redirect());var r=getServiceData(e).value;for(var o in shoppingCart){var n=shoppingCart[o].proizvodId,a=/(\d+)/g,i=n.match(a),d=takeProductName(i,r),c=takeCategoryIdFromProducts(i,r),s=takeImage(getRandomInt(1,4),slike);createProductInCart(s,shoppingCart[o].proizvodCena,shoppingCart[o].proizvodKolicina,d,i,c),document.getElementById("itemsInCart").innerHTML="SADRŽAJ VAŠE KORPE ZA KUPOVINU"}}function createProductInCart(e,t,r,o,n,a){var i=document.getElementById("addProduct"),d=document.getElementsByClassName("priceTag").length;cntProduct=void 0==d||0==d?cntProduct:d;var c=document.createElement("div");c.setAttribute("class","col-md-3 col-sm-6 introFadeIn"),i.appendChild(c);var s=document.createElement("p");s.setAttribute("class","product-title"),s.innerHTML=o,c.appendChild(s);var u=takeCategory(a,categories),l=document.createElement("p");l.setAttribute("class","text-left category-title"),l.innerHTML=u,c.appendChild(l);var m=document.createElement("img");m.setAttribute("src",e),m.setAttribute("alt","proizvod"),m.setAttribute("class","img-responsive"),m.setAttribute("width","200"),c.appendChild(m);var p=document.createElement("p");p.setAttribute("class","valuta text-left"),p.innerHTML="rsd",c.appendChild(p),cntProduct+=1;var g=document.createElement("p");g.setAttribute("id","cenaP"+n),g.setAttribute("class","priceTag"),g.innerHTML=t,c.appendChild(g);var v=document.createElement("div");v.setAttribute("class","clr"),c.appendChild(v);var h=document.createElement("input");h.setAttribute("type","number"),h.setAttribute("value","1"),h.setAttribute("id","kolicinaP"+n),c.appendChild(h);var C=document.createElement("p");C.setAttribute("class","text-muted"),C.innerHTML="kolicina",c.appendChild(C);var f=document.createElement("button");f.setAttribute("class","btn btn-danger btn-sm"),f.setAttribute("id","P"+n),f.setAttribute("onclick","removeItem(this)"),f.innerHTML="Ukloni iz korpe",c.appendChild(f)}var uName=sessionStorage.getItem("loggedUser");document.getElementById("loggedIn").innerHTML="Welcome, "+uName+"!",document.getElementById("logout").innerHTML="Logout";var slike=[{id:1,path:"images/1.jpg"},{id:2,path:"images/2.jpg"},{id:3,path:"images/3.jpg"},{id:4,path:"images/4.jpg"}],cntProduct=0,categories=getServiceData("http://services.odata.org/V3/Northwind/Northwind.svc/Categories?$format=json").value,suma=0,shoppingCart=[],filter=0;document.getElementById("dodajNovProizvod").addEventListener("click",function(){createProduct(document.getElementById("imagePath").value,document.getElementById("productPrice").valueAsNumber,document.getElementById("productName").value,document.getElementById("categoryName").value)});
//# sourceMappingURL=cart.min.js.map
